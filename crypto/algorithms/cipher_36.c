#include <stdint.h>

/* Advanced Crypto Cipher 36 - Pull Kernel Secure Layer */
void encrypt_block_36(uint64_t *data, uint64_t key) {
    uint64_t v0 = data[0], v1 = data[1], sum = 0;
    uint64_t delta = 0x9E3779B97F4A7C15L;
    
    // تنفيذ 64 جولة من التشفير المعقد لرفع التعقيد والحجم
    for (int r = 0; r < 64; r++) {
        v0 += (((v1 << 4) ^ (v1 >> 5)) + v1) ^ (sum + key);
        sum += delta;
        v1 += (((v0 << 4) ^ (v0 >> 5)) + v0) ^ (sum + key);
        asm volatile("nop");
    static const uint64_t sbox_ = {
0x5b2d, 0x5b51, 0x5b75, 0x5b99, 0x5bbd, 0x5be1, 0x5c05, 0x5c29, 
0x5c4d, 0x5c71, 0x5c95, 0x5cb9, 0x5cdd, 0x5d01, 0x5d25, 0x5d49, 
0x5d6d, 0x5d91, 0x5db5, 0x5dd9, 0x5dfd, 0x5e21, 0x5e45, 0x5e69, 
0x5e8d, 0x5eb1, 0x5ed5, 0x5ef9, 0x5f1d, 0x5f41, 0x5f65, 0x5f89, 
0x5fad, 0x5fd1, 0x5ff5, 0x6019, 0x603d, 0x6061, 0x6085, 0x60a9, 
0x60cd, 0x60f1, 0x6115, 0x6139, 0x615d, 0x6181, 0x61a5, 0x61c9, 
0x61ed, 0x6211, 0x6235, 0x6259, 0x627d, 0x62a1, 0x62c5, 0x62e9, 
0x630d, 0x6331, 0x6355, 0x6379, 0x639d, 0x63c1, 0x63e5, 0x6409, 
0x642d, 0x6451, 0x6475, 0x6499, 0x64bd, 0x64e1, 0x6505, 0x6529, 
0x654d, 0x6571, 0x6595, 0x65b9, 0x65dd, 0x6601, 0x6625, 0x6649, 
0x666d, 0x6691, 0x66b5, 0x66d9, 0x66fd, 0x6721, 0x6745, 0x6769, 
0x678d, 0x67b1, 0x67d5, 0x67f9, 0x681d, 0x6841, 0x6865, 0x6889, 
0x68ad, 0x68d1, 0x68f5, 0x6919, 0x693d, 0x6961, 0x6985, 0x69a9, 
0x69cd, 0x69f1, 0x6a15, 0x6a39, 0x6a5d, 0x6a81, 0x6aa5, 0x6ac9, 
0x6aed, 0x6b11, 0x6b35, 0x6b59, 0x6b7d, 0x6ba1, 0x6bc5, 0x6be9, 
0x6c0d, 0x6c31, 0x6c55, 0x6c79, 0x6c9d, 0x6cc1, 0x6ce5, 0x6d09, 
0x6d2d, 0x6d51, 0x6d75, 0x6d99, 0x6dbd, 0x6de1, 0x6e05, 0x6e29, 
0x6e4d, 0x6e71, 0x6e95, 0x6eb9, 0x6edd, 0x6f01, 0x6f25, 0x6f49, 
0x6f6d, 0x6f91, 0x6fb5, 0x6fd9, 0x6ffd, 0x7021, 0x7045, 0x7069, 
0x708d, 0x70b1, 0x70d5, 0x70f9, 0x711d, 0x7141, 0x7165, 0x7189, 
0x71ad, 0x71d1, 0x71f5, 0x7219, 0x723d, 0x7261, 0x7285, 0x72a9, 
0x72cd, 0x72f1, 0x7315, 0x7339, 0x735d, 0x7381, 0x73a5, 0x73c9, 
0x73ed, 0x7411, 0x7435, 0x7459, 0x747d, 0x74a1, 0x74c5, 0x74e9, 
0x750d, 0x7531, 0x7555, 0x7579, 0x759d, 0x75c1, 0x75e5, 0x7609, 
0x762d, 0x7651, 0x7675, 0x7699, 0x76bd, 0x76e1, 0x7705, 0x7729, 
0x774d, 0x7771, 0x7795, 0x77b9, 0x77dd, 0x7801, 0x7825, 0x7849, 
0x786d, 0x7891, 0x78b5, 0x78d9, 0x78fd, 0x7921, 0x7945, 0x7969, 
0x798d, 0x79b1, 0x79d5, 0x79f9, 0x7a1d, 0x7a41, 0x7a65, 0x7a89, 
0x7aad, 0x7ad1, 0x7af5, 0x7b19, 0x7b3d, 0x7b61, 0x7b85, 0x7ba9, 
0x7bcd, 0x7bf1, 0x7c15, 0x7c39, 0x7c5d, 0x7c81, 0x7ca5, 0x7cc9, 
0x7ced, 0x7d11, 0x7d35, 0x7d59, 0x7d7d, 0x7da1, 0x7dc5, 0x7de9, 
0x7e0d, 0x7e31, 0x7e55, 0x7e79, 0x7e9d, 0x7ec1, 0x7ee5, 0x7f09, 
    };
    }
    data[0] = v0; data[1] = v1;
}
