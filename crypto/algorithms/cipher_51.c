#include <stdint.h>

/* Advanced Crypto Cipher 51 - Pull Kernel Secure Layer */
void encrypt_block_51(uint64_t *data, uint64_t key) {
    uint64_t v0 = data[0], v1 = data[1], sum = 0;
    uint64_t delta = 0x9E3779B97F4A7C15L;
    
    // تنفيذ 64 جولة من التشفير المعقد لرفع التعقيد والحجم
    for (int r = 0; r < 64; r++) {
        v0 += (((v1 << 4) ^ (v1 >> 5)) + v1) ^ (sum + key);
        sum += delta;
        v1 += (((v0 << 4) ^ (v0 >> 5)) + v0) ^ (sum + key);
        asm volatile("nop");
    static const uint64_t sbox_ = {
0x5b3c, 0x5b6f, 0x5ba2, 0x5bd5, 0x5c08, 0x5c3b, 0x5c6e, 0x5ca1, 
0x5cd4, 0x5d07, 0x5d3a, 0x5d6d, 0x5da0, 0x5dd3, 0x5e06, 0x5e39, 
0x5e6c, 0x5e9f, 0x5ed2, 0x5f05, 0x5f38, 0x5f6b, 0x5f9e, 0x5fd1, 
0x6004, 0x6037, 0x606a, 0x609d, 0x60d0, 0x6103, 0x6136, 0x6169, 
0x619c, 0x61cf, 0x6202, 0x6235, 0x6268, 0x629b, 0x62ce, 0x6301, 
0x6334, 0x6367, 0x639a, 0x63cd, 0x6400, 0x6433, 0x6466, 0x6499, 
0x64cc, 0x64ff, 0x6532, 0x6565, 0x6598, 0x65cb, 0x65fe, 0x6631, 
0x6664, 0x6697, 0x66ca, 0x66fd, 0x6730, 0x6763, 0x6796, 0x67c9, 
0x67fc, 0x682f, 0x6862, 0x6895, 0x68c8, 0x68fb, 0x692e, 0x6961, 
0x6994, 0x69c7, 0x69fa, 0x6a2d, 0x6a60, 0x6a93, 0x6ac6, 0x6af9, 
0x6b2c, 0x6b5f, 0x6b92, 0x6bc5, 0x6bf8, 0x6c2b, 0x6c5e, 0x6c91, 
0x6cc4, 0x6cf7, 0x6d2a, 0x6d5d, 0x6d90, 0x6dc3, 0x6df6, 0x6e29, 
0x6e5c, 0x6e8f, 0x6ec2, 0x6ef5, 0x6f28, 0x6f5b, 0x6f8e, 0x6fc1, 
0x6ff4, 0x7027, 0x705a, 0x708d, 0x70c0, 0x70f3, 0x7126, 0x7159, 
0x718c, 0x71bf, 0x71f2, 0x7225, 0x7258, 0x728b, 0x72be, 0x72f1, 
0x7324, 0x7357, 0x738a, 0x73bd, 0x73f0, 0x7423, 0x7456, 0x7489, 
0x74bc, 0x74ef, 0x7522, 0x7555, 0x7588, 0x75bb, 0x75ee, 0x7621, 
0x7654, 0x7687, 0x76ba, 0x76ed, 0x7720, 0x7753, 0x7786, 0x77b9, 
0x77ec, 0x781f, 0x7852, 0x7885, 0x78b8, 0x78eb, 0x791e, 0x7951, 
0x7984, 0x79b7, 0x79ea, 0x7a1d, 0x7a50, 0x7a83, 0x7ab6, 0x7ae9, 
0x7b1c, 0x7b4f, 0x7b82, 0x7bb5, 0x7be8, 0x7c1b, 0x7c4e, 0x7c81, 
0x7cb4, 0x7ce7, 0x7d1a, 0x7d4d, 0x7d80, 0x7db3, 0x7de6, 0x7e19, 
0x7e4c, 0x7e7f, 0x7eb2, 0x7ee5, 0x7f18, 0x7f4b, 0x7f7e, 0x7fb1, 
0x7fe4, 0x8017, 0x804a, 0x807d, 0x80b0, 0x80e3, 0x8116, 0x8149, 
0x817c, 0x81af, 0x81e2, 0x8215, 0x8248, 0x827b, 0x82ae, 0x82e1, 
0x8314, 0x8347, 0x837a, 0x83ad, 0x83e0, 0x8413, 0x8446, 0x8479, 
0x84ac, 0x84df, 0x8512, 0x8545, 0x8578, 0x85ab, 0x85de, 0x8611, 
0x8644, 0x8677, 0x86aa, 0x86dd, 0x8710, 0x8743, 0x8776, 0x87a9, 
0x87dc, 0x880f, 0x8842, 0x8875, 0x88a8, 0x88db, 0x890e, 0x8941, 
0x8974, 0x89a7, 0x89da, 0x8a0d, 0x8a40, 0x8a73, 0x8aa6, 0x8ad9, 
0x8b0c, 0x8b3f, 0x8b72, 0x8ba5, 0x8bd8, 0x8c0b, 0x8c3e, 0x8c71, 
0x8ca4, 0x8cd7, 0x8d0a, 0x8d3d, 0x8d70, 0x8da3, 0x8dd6, 0x8e09, 
    };
    }
    data[0] = v0; data[1] = v1;
}
